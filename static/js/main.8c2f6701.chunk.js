(this["webpackJsonpg2chat2-client"]=this["webpackJsonpg2chat2-client"]||[]).push([[0],{102:function(e,a,t){"use strict";t.r(a);var n=t(0),s=t(1),r=t.n(s),c=t(40),i=t.n(c),l=(t(48),t(2)),o=(t(49),t(22)),d=t(104),u=t(41),m=t.n(u),j=r.a.createContext();function b(){return Object(s.useContext)(j)}var f=function(e){var a=e.id,t=e.setId,r=e.children,c=Object(s.useState)(),i=Object(l.a)(c,2),o=i[0],d=i[1],u=Object(s.useState)([]),b=Object(l.a)(u,2),f=b[0],h=b[1],O=Object(s.useState)(null),g=Object(l.a)(O,2),p=g[0],x=g[1],v=Object(s.useState)(null),C=Object(l.a)(v,2),N=C[0],S=C[1];return Object(s.useEffect)((function(){var e=m()("https://g2chat2.herokuapp.com/",{query:{id:a}});return d(e),e.on("server_message",(function(a){if("SUCCESS"===a.type)if("ID created successfully."===a.data.message){if(localStorage.getItem("g2Chat-user")){var n=JSON.parse(localStorage.getItem("g2Chat-user"));e.emit("delete_id",{name:n.id,uniqueID:n.uniqueID,status:"new_login"})}localStorage.setItem("g2Chat-user",JSON.stringify({id:a.data.account.id,uniqueID:a.data.account.uniqueID})),x(null),t(a.data.account.id)}else"ID removed successfully."===a.data.message?(localStorage.removeItem("g2Chat-user"),t(null),window.location.reload()):"ID name changed successfully."===a.data.message&&(localStorage.setItem("g2Chat-user",JSON.stringify({id:a.data.account.id,uniqueID:a.data.account.uniqueID})),t(a.data.account.id),S(null));else"ERROR"===a.type&&("ID and uniqueID does not match."===a.data.message?S(a.data.message):x(a.data.message))})),e.on("all_channels",(function(e){h(e)})),function(){return e.close()}}),[a,t]),Object(n.jsx)(j.Provider,{value:{socket:o,channels:f,createIDError:p,changeIDError:N},children:r})};function h(e){return""===e.trim()||e.trim().length<5?{valid:!1,error:"ID must contain at least 5 characters."}:e.trim().length>20?{valid:!1,error:"ID must not exceed 20 characters."}:e.trim().match(/[^a-zA-Z0-9]/)?{valid:!1,error:"ID must contain only numbers and/or letters."}:{valid:!0,error:null}}var O=function(){var e=Object(s.useRef)(),a=Object(s.useState)([]),t=Object(l.a)(a,2),r=t[0],c=t[1],i=b(),u=i.socket,m=i.createIDError,j=!!localStorage.getItem("g2Chat-user");return Object(s.useEffect)((function(){m&&c([m])}),[m,c]),Object(n.jsxs)("div",{id:"login",className:"login",children:[Object(n.jsx)("div",{id:"loginLogo",className:"loginLogo",children:Object(n.jsx)("h1",{className:"loginLogo-h1",children:"g2Chat"})}),Object(n.jsxs)("form",{className:"loginForm",onSubmit:function(a){return function(a){a.preventDefault();var t=e.current.value,n=h(t),s=n.valid,r=n.error;if(s){var i=Object(d.a)();u.emit("create_id",{name:t,uniqueID:i})}else c((function(e){return Object(o.a)(new Set([].concat(Object(o.a)(e),[r])))}))}(a)},children:[Object(n.jsx)("h1",{className:"loginForm-h1",children:"Create an ID"}),Object(n.jsx)("input",{className:"input-01 mv-10",type:"text",ref:e,required:!0}),Object(n.jsx)("button",{className:"button-01",type:"submit",children:"Chat with new ID"}),j&&Object(n.jsx)("h1",{className:"loginForm-h1",children:"or"}),j&&Object(n.jsxs)("button",{type:"button",className:"button-01 mt-5",onClick:function(){return function(){var e=JSON.parse(localStorage.getItem("g2Chat-user"));u.emit("continue_login",{name:e.id,uniqueID:e.uniqueID})}()},children:["Resume Session as ",JSON.parse(localStorage.getItem("g2Chat-user")).id]}),r.length>0&&Object(n.jsx)("ul",{className:"loginForm-errorbox",children:r.map((function(e,a){return Object(n.jsx)("li",{className:"loginForm-error",children:e},"loginformerror".concat(a))}))})]})]})},g=function(e){var a=e.id,t=Object(s.useRef)(null),r=b().socket;return Object(n.jsx)("div",{id:"sidebarCreateChannel",className:"sidebarCreateChannel",children:Object(n.jsxs)("form",{id:"sidebarCreateChannel-form",className:"sidebarCreateChannel-form",onSubmit:function(e){return function(e){e.preventDefault(),r.emit("channel",{action:"create_channel",data:{channel:t.current.value,id:a}}),t.current.value=""}(e)},children:[Object(n.jsx)("h3",{className:"sidebarCreateChannel-h3",children:"Create a new Channel"}),Object(n.jsx)("input",{className:"input-01",type:"text",placeholder:"Create a channel...",ref:t,required:!0}),Object(n.jsx)("button",{className:"button-01 mt-5",children:"Create"})]})})},p=r.a.createContext();function x(){return Object(s.useContext)(p)}var v=function(e){var a=e.children,t=b().socket,r=Object(s.useState)(null),c=Object(l.a)(r,2),i=c[0],o=c[1];return Object(n.jsx)(p.Provider,{value:{currentChannel:i,changeChannel:function(e){var a=e.channel,n=e.id;a!==i&&(t.emit("channel",{action:"change_channel",data:{channel:a,id:n}}),o(a))}},children:a})},C=function(e){var a=e.id,t=e.channel,s=e.setSidebarOpen,r=x().changeChannel;return Object(n.jsx)("div",{id:"channelCard-".concat(t),className:"channelCard",onClick:function(){return r({channel:t,id:a}),void(window.innerWidth<600&&s(!1))},children:Object(n.jsx)("p",{className:"channelCard-p",children:t})})},N=function(e){var a=e.id,t=e.setSidebarOpen,s=b().channels;return Object(n.jsxs)("div",{className:"channelList",children:[Object(n.jsx)("div",{className:"channelListTitle",children:Object(n.jsx)("h2",{className:"channelListTitle-h2",children:"Channels"})}),Object(n.jsx)("div",{className:"channelListCon",children:s.map((function(e){return Object(n.jsx)(C,{channel:e,id:a,setSidebarOpen:t},"channelcard".concat(e))}))})]})},S=function(e){var a=e.id,t=e.uniqueID,r=(e.setId,Object(s.useRef)()),c=Object(s.useState)(!1),i=Object(l.a)(c,2),o=i[0],d=i[1],u=Object(s.useState)([]),m=Object(l.a)(u,2),j=m[0],f=m[1],O=b(),g=O.socket,p=O.changeIDError,v=x().currentChannel;Object(s.useEffect)((function(){p&&d(!0)}),[p]);var C=o?Object(n.jsxs)("form",{className:"sidebarLoginCard-form",onSubmit:function(e){return function(e){e.preventDefault();var a=h(r.current.value),t=a.valid,n=a.error;if(t){var s=JSON.parse(localStorage.getItem("g2Chat-user")),c=s.id,i=s.uniqueID;g.emit("change_id",{prevName:c,newName:r.current.value,uniqueID:i,channel:v}),r.current.value="",d(!1)}else f(n)}(e)},children:[Object(n.jsx)("input",{type:"text",className:"sidebarLoginCard-form-input",placeholder:"Enter your ID...",defaultValue:a,ref:r}),j&&Object(n.jsx)("p",{className:"sidebarLoginCard-form-error",children:j}),p&&Object(n.jsx)("p",{className:"sidebarLoginCard-form-error",children:p}),Object(n.jsxs)("div",{className:"sidebarLoginCard-form-btngrp",children:[Object(n.jsx)("button",{className:"sidebarLoginCard-form-btn",onClick:function(){return d(!1)},children:"Cancel"}),Object(n.jsx)("button",{className:"sidebarLoginCard-form-btn",type:"submit",children:"Submit"})]})]}):Object(n.jsx)("p",{className:"sidebarLoginCard-p",children:a}),N=!o&&Object(n.jsxs)("div",{className:"sidebarLoginCard-btngrp",children:[Object(n.jsx)("button",{className:"sidebarLoginCard-btn",onClick:function(){return d(!0)},children:Object(n.jsx)("p",{children:"Change ID"})}),Object(n.jsx)("button",{className:"sidebarLoginCard-btn sidebarLoginCard-btn-reset",onClick:function(e){return function(e){e.preventDefault(),localStorage.removeItem("g2Chat-user"),g.emit("delete_id",{name:a,uniqueID:t}),window.location.reload()}(e)},children:Object(n.jsx)("p",{children:"Reset"})})]});return Object(n.jsxs)("div",{className:"sidebarLoginCard",children:[Object(n.jsx)("h2",{className:"sidebarLoginCard-h2",children:"Your ID"}),C,N]})},I=function(e){var a=e.sidebarOpen,t=e.setSidebarOpen,s=e.setId,r=JSON.parse(localStorage.getItem("g2Chat-user"));return Object(n.jsxs)("div",{id:"sidebar",className:"sidebar",children:[a&&Object(n.jsx)("button",{className:"sidebar-btn",onClick:function(){return t(!1)},children:Object(n.jsx)("i",{className:"fas fa-times"})}),Object(n.jsxs)("div",{id:"sidebarLogo",className:"sidebarLogo",children:[Object(n.jsx)("i",{className:"far fa-comment-dots"}),Object(n.jsx)("h1",{className:"sidebarLogo-h1",children:"g2Chat"})]}),Object(n.jsx)(g,{id:r.id}),Object(n.jsx)(S,{id:r.id,uniqueID:r.uniqueID,setId:s}),Object(n.jsx)(N,{id:r.id,setSidebarOpen:t})]})},D={"application/pdf":"fas fa-file-pdf messageCard-file-pdf","application/msword":"fas fa-file-word messageCard-file-word","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"fas fa-file-word messageCard-file-word","application/vnd.ms-powerpoint":"fas fa-file-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation":"fas fa-file-powerpoint","application/vnd.ms-excel":"fas fa-file-excel messageCard-file-xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"fas fa-file-excel messageCard-file-xls","application/zip":"fas fa-file-archive messageCard-file-normal","application/vnd.rar":"fas fa-file-archive messageCard-file-normal","text/csv":"fas fa-file-csv messageCard-file-normal"};var w=t(17),y=t.n(w),L=t(42),q=t.n(L),k=function(e){var a,t=e.message,s=t.id,r=t.uniqueID,c=t.type,i=t.content,l=t.filename,o=t.timestamp,d=JSON.parse(localStorage.getItem("g2Chat-user"));return a=D.hasOwnProperty(c)?Object(n.jsxs)("a",{download:l,className:"messageCard-file",href:i,children:[Object(n.jsx)("i",{className:"messageCard-file-i ".concat(D[c])}),Object(n.jsx)("p",{className:"messageCard-file-p",children:l})]}):"image/jpeg"===c||"image/jpg"===c||"image/png"===c||"image/svg"===c||"image/gif"===c?Object(n.jsx)("img",{src:i,alt:"message",className:"messageCard-img"}):"https://"===i.slice(0,8)?"https://youtu.be/"===i.slice(0,17)||"https://www.youtube.com/"===i.slice(0,24)?Object(n.jsx)(q.a,{className:"messageCard-vid",url:i,controls:!0}):Object(n.jsx)("a",{className:"messageCard-text",href:i,children:i}):Object(n.jsx)("p",{className:"messageCard-text",children:i}),Object(n.jsx)("div",{className:d.uniqueID===r?"messageCard messageCard-user":"messageCard",children:Object(n.jsxs)("div",{className:"messageCard-upper",children:[Object(n.jsx)("p",{className:"messageCard-user",children:s}),a,Object(n.jsx)("p",{className:"messageCard-timestamp",children:y()(new Date(o)).calendar(Date.now())})]})})},J=function(e){var a=e.message,t=a.userJoin,s=a.timestamp;return Object(n.jsxs)("div",{className:"userJoin",children:[Object(n.jsx)("p",{className:"userJoin-user",children:t}),Object(n.jsx)("p",{className:"userJoin-timestamp",children:y()(new Date(s)).calendar(Date.now())})]})},_=function(e){var a=e.currentChannel,t=e.sidebarOpen,r=e.setSidebarOpen,c=b().socket,i=Object(s.useState)(),o=Object(l.a)(i,2),d=o[0],u=o[1],m=Object(s.useState)(!1),j=Object(l.a)(m,2),f=j[0],h=j[1],O=Object(s.useRef)(),g=Object(s.useRef)(),p=Object(s.useRef)(),x="";return Object(s.useEffect)((function(){c.on("channel_messages",(function(e){u(e),O.current.scrollTop=O.current.scrollHeight})),c.on("user_join_channel",(function(e){}))}),[c]),Object(n.jsxs)("div",{className:"conversations",children:[!t&&Object(n.jsx)("button",{className:"menuToggle",onClick:function(){return r(!0)},children:Object(n.jsx)("i",{className:"fas fa-bars"})}),Object(n.jsx)("h2",{className:"conversations-title",children:a}),Object(n.jsx)("div",{id:"conversations-dialog",className:"conversations-dialog",ref:O,children:d&&d.map((function(e,a){return e.userJoin?Object(n.jsx)(J,{message:e},"message-".concat(a)):Object(n.jsx)(k,{message:e},"message-".concat(a))}))}),Object(n.jsxs)("form",{className:"conversations-form",onSubmit:function(e){return function(e){e.preventDefault();var t=JSON.parse(localStorage.getItem("g2Chat-user")),n=t.id,s=t.uniqueID,r=f?p.current.files[0].type:"text",i=f?p.current.files[0]:g.current.value,l=a;if(f&&!D.hasOwnProperty(r)&&"image/png"!==r&&"image/jpg"!==r)return h(!1),g.current.value="",void(p.current.value="");var o,d={user:{id:n,uniqueID:s},type:r,content:i,channel:l};if("text"===r){if(""===(o=i).trim()||o.length>1600)return!1;d.content=i,c.emit("send_message",d)}else{var u=new FileReader;u.onload=function(){var e=u.result;d.filename=i.name,i=e.toString("base64"),d.content=i,c.emit("send_message",d),h(!1)},u.readAsDataURL(i)}g.current.value="",p.current.value=""}(e)},children:[Object(n.jsx)("label",{htmlFor:"fileUpload",className:"conversations-form-inputfile-label",children:Object(n.jsx)("i",{className:"fas fa-paperclip"})}),Object(n.jsx)("input",{id:"fileUpload",className:"conversations-form-inputfile",type:"file",ref:p,accept:".png,.jpg,.pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.zip,.rar,.csv",onChange:function(){return function(){if(!p.current.value)return g.current.value="",void h(!1);x=p.current.files[0].name,g.current.value=x,h(!0)}()}}),Object(n.jsxs)("div",{className:"conversations-form-grp",children:[Object(n.jsx)("input",{className:"conversations-form-input",type:"text",ref:g,disabled:f,required:!f}),Object(n.jsx)("button",{className:"conversations-form-submit",type:"submit",children:Object(n.jsx)("i",{className:"fas fa-paper-plane"})})]})]})]})},E=t.p+"static/media/chatnow.b3198a05.png",R=function(e){var a=e.sidebarOpen,t=e.setSidebarOpen,s=x().currentChannel,r=s?Object(n.jsx)(_,{currentChannel:s,sidebarOpen:a,setSidebarOpen:t}):Object(n.jsxs)("div",{className:"noSelectedChannel",children:[Object(n.jsx)("img",{src:E,alt:"chat",className:"noSelectedChannel-img"}),Object(n.jsxs)("h3",{className:"noSelectedChannel-h3",children:[!a&&Object(n.jsx)("button",{className:"menuToggle",onClick:function(){return t(!0)},children:Object(n.jsx)("i",{className:"fas fa-bars"})}),"Please select a channel to start!"]})]});return Object(n.jsx)("div",{id:"main",className:"main",children:r})},F=function(e){var a=e.id,t=e.setId,r=Object(s.useState)(!0),c=Object(l.a)(r,2),i=c[0],o=c[1];return Object(s.useEffect)((function(){window.addEventListener("resize",(function(){window.innerWidth>600?o(!0):o(!1)}))}),[o]),Object(n.jsxs)("div",{id:"dashboard",className:"dashboard",children:[i&&Object(n.jsx)(I,{id:a,setId:t,sidebarOpen:i,setSidebarOpen:o}),Object(n.jsx)(R,{id:a,sidebarOpen:i,setSidebarOpen:o})]})};var P=function(){var e=Object(s.useState)(null),a=Object(l.a)(e,2),t=a[0],r=a[1],c=JSON.parse(localStorage.getItem("g2Chat-user")),i=t?Object(n.jsx)(F,{user:c,setId:r}):Object(n.jsx)(O,{id:t,setId:r});return Object(n.jsx)("div",{className:"App",children:Object(n.jsx)(f,{setId:r,children:Object(n.jsx)(v,{children:i})})})};i.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(P,{})}),document.getElementById("root"))},48:function(e,a,t){},49:function(e,a,t){}},[[102,1,2]]]);
//# sourceMappingURL=main.8c2f6701.chunk.js.map